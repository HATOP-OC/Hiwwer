# Директорія бекапів бази даних

Ця директорія призначена для зберігання файлів бекапів бази даних PostgreSQL.

## Структура

```
backups/
├── README.md                     # Цей файл документації
├── backup_YYYY-MM-DD_HH-MM-SS.sql # Файли бекапів (не включені в git)
└── ...                           # Інші файли бекапів
```

## Автоматичне створення бекапів

Бекапи створюються автоматично через:

1. **Веб-інтерфейс адміністратора**
   - Панель адміна → База даних → Створити бекап

2. **API endpoint**
   ```
   POST /v1/admin/database/backup
   ```

3. **Командний рядок**
   ```bash
   ./backup-db.sh manual
   ```

4. **Автоматичний cron**
   - Щодня о 2:00 ночі
   - Налаштовується через backup-cron.txt

## Формат імен файлів

Файли бекапів мають формат імені:
```
backup_YYYY-MM-DDTHH-MM-SS-sssZ.sql
```

Приклад: `backup_2025-06-22T09-42-25-061Z.sql`

## Політика зберігання

- **Локально**: зберігаються останні 10 бекапів
- **Автоочищення**: старі бекапи видаляються автоматично
- **Розмір**: залежить від розміру бази даних

## Безпека

⚠️ **ВАЖЛИВО**: 
- Файли бекапів містять чутливі дані
- Вони НЕ включені в систему контролю версій (git)
- Забезпечте безпечне зберігання та передачу

## Відновлення

Для відновлення бази даних з бекапу:

1. **Через веб-інтерфейс**: Панель адміна → База даних → Відновити
2. **Через API**: POST /v1/admin/database/restore
3. **Вручну**: 
   ```bash
   psql -h host -U user -d database -f backup_file.sql
   ```

## Моніторинг

Перевіряйте регулярно:
- ✅ Створення бекапів відбувається за розкладом
- ✅ Файли бекапів не пошкоджені
- ✅ Процес відновлення працює коректно
- ✅ Достатньо місця на диску

## Логи

Логи процесу бекапування знаходяться в:
- `/var/log/db-backup.log` - щоденні бекапи
- `/var/log/db-backup-weekly.log` - тижневі бекапи
- Логи сервера - через системний журнал

## Технічні деталі

- **Формат**: PostgreSQL SQL dump (текстовий)
- **Опції pg_dump**: `--clean --create --if-exists`
- **Кодування**: UTF-8
- **Стиснення**: немає (можна додати gzip в майбутньому)

## Усунення проблем

### Якщо бекап не створюється:
1. Перевірте підключення до БД
2. Переконайтеся, що PostgreSQL client встановлено
3. Перевірте права доступу до директорії
4. Переглянте логи помилок

### Якщо не вистачає місця:
1. Збільште розмір диска
2. Налаштуйте більш агресивне очищення
3. Додайте стиснення файлів
4. Перемістіть старі бекапи в архів

### Контакти

За питаннями роботи з бекапами звертайтеся до системного адміністратора.

---

*Цей файл створено автоматично. Не видаляйте його.*
